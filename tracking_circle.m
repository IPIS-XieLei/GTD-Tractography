function [Trace,stopreason] = tracking_circle(Aall,start_point,step_size,ROI_positions_mask)

% Parameter
detaT = 0.1;
stop = 0; notstop = 0;
p0 = start_point;
Trace = zeros(0,3); 
stopTrace = zeros(0,3);
oldvector = [0 0 0];
A=Aall{4};
% Tracking
while(1)
    intp0 = round(p0);

    if size(Trace,1)>600/step_size
        break
    end
 
 
    % Cal A
    if size(A,2) == 4
        f = @(p) (A*[p(1), p(2), p(3), 1]')';
    elseif size(A,2) == 6
        f = @(p) (A*[p(1)^2, p(2)^2, p(1)*p(2), p(1), p(2), 1]')';
    elseif size(A,2) == 10
        f = @(p) (A*[p(1)^2, p(2)^2, p(3)^2, p(1)*p(2), p(1)*p(3), p(2)*p(3), p(1), p(2), p(3), 1]')';
    elseif size(A,2) == 11
        f = @(p) (A*[p(1)^3, p(2)^3, (p(1)^2)*p(2), p(1)*(p(2)^2), p(1)^2, p(2)^2, p(1)*p(2), p(1), p(2), 1]')';
    elseif size(A,2) == 15
        f = @(p) (A*[p(1)^4, p(2)^4, (p(1)^3)*p(2), p(1)*(p(2)^3), (p(1)^2)*(p(2)^2),p(1)^3, p(2)^3, (p(1)^2)*p(2), p(1)*(p(2)^2), p(1)^2, p(2)^2, ...
                    p(1)*p(2), p(1), p(2), 1]')';  
    elseif size(A,2) == 20
        f = @(p) (A*[p(1)^3, p(2)^3, p(3)^3, (p(1)^2)*p(2), (p(1)^2)*p(3), (p(2)^2)*p(1), (p(2)^2)*p(3), (p(3)^2)*p(1), (p(3)^2)*p(2), p(1)*p(2)*p(3), ...
                    p(1)^2, p(2)^2, p(3)^2, p(1)*p(2), p(1)*p(3), p(2)*p(3), p(1), p(2), p(3), 1]')';
    elseif size(A,2) == 35
        f = @(p) (A*[p(1)^4, p(2)^4, p(3)^4, (p(1)^3)*p(2), (p(1)^3)*p(3), (p(2)^3)*p(1), (p(2)^3)*p(3), (p(3)^3)*p(1), (p(3)^3)*p(2), (p(1)^2)*(p(2)^2), (p(1)^2)*(p(3)^2), (p(2)^2)*(p(3)^2), (p(1)^2)*p(2)*p(3), (p(2)^2)*p(1)*p(3), (p(3)^2)*p(1)*p(2), ...
                    p(1)^3, p(2)^3, p(3)^3, (p(1)^2)*p(2), (p(1)^2)*p(3), (p(2)^2)*p(1), (p(2)^2)*p(3), (p(3)^2)*p(1), (p(3)^2)*p(2), p(1)*p(2)*p(3), ...
                    p(1)^2, p(2)^2, p(3)^2, p(1)*p(2), p(1)*p(3), p(2)*p(3), ...
                    p(1), p(2), p(3), 1]')';
    elseif size(A,2) == 56
        f = @(p) (A*[p(1)^5, p(2)^5, p(3)^5, (p(1)^4)*p(2), (p(1)^4)*p(3), (p(2)^4)*p(1), (p(2)^4)*p(3), (p(3)^4)*p(1), (p(3)^4)*p(2), (p(1)^3)*(p(2)^2), (p(1)^3)*(p(3)^2), (p(2)^3)*(p(1)^2), (p(2)^3)*(p(3)^2), (p(3)^3)*(p(1)^2), (p(3)^3)*(p(2)^2), (p(1)^3)*p(2)*p(3), (p(2)^3)*p(1)*p(3), (p(3)^3)*p(1)*p(2), (p(1)^2)*(p(2)^2)*p(3), (p(1)^2)*p(2)*(p(3)^2), p(1)*(p(2)^2)*(p(3)^2), ...
                    p(1)^4, p(2)^4, p(3)^4, (p(1)^3)*p(2), (p(1)^3)*p(3), (p(2)^3)*p(1), (p(2)^3)*p(3), (p(3)^3)*p(1), (p(3)^3)*p(2), (p(1)^2)*(p(2)^2), (p(1)^2)*(p(3)^2), (p(2)^2)*(p(3)^2), (p(1)^2)*p(2)*p(3), (p(2)^2)*p(1)*p(3), (p(3)^2)*p(1)*p(2), ...
                    p(1)^3, p(2)^3, p(3)^3, (p(1)^2)*p(2), (p(1)^2)*p(3), (p(2)^2)*p(1), (p(2)^2)*p(3), (p(3)^2)*p(1), (p(3)^2)*p(2), p(1)*p(2)*p(3), ...
                    p(1)^2, p(2)^2, p(3)^2, p(1)*p(2), p(1)*p(3), p(2)*p(3), ...
                    p(1), p(2), p(3), 1]')';
    elseif size(A,2) == 84
        f = @(p) (A*[p(1), p(1)^2, p(1)^3, p(1)^4, p(1)^5, p(1)^6, p(2), p(1)*p(2), p(1)^2*p(2), p(1)^3*p(2), p(1)^4*p(2), p(1)^5*p(2), ...
                    p(2)^2, p(1)*p(2)^2, p(1)^2*p(2)^2, p(1)^3*p(2)^2, p(1)^4*p(2)^2, p(2)^3, p(1)*p(2)^3, p(1)^2*p(2)^3, p(1)^3*p(2)^3, ...
                    p(2)^4, p(1)*p(2)^4, p(1)^2*p(2)^4, p(2)^5, p(1)*p(2)^5, p(2)^6, p(3), p(1)*p(3), p(1)^2*p(3), p(1)^3*p(3), p(1)^4*p(3), p(1)^5*p(3), ...
                    p(2)*p(3), p(1)*p(2)*p(3), p(1)^2*p(2)*p(3), p(1)^3*p(2)*p(3), p(1)^4*p(2)*p(3), p(2)^2*p(3), p(1)*p(2)^2*p(3), p(1)^2*p(2)^2*p(3), p(1)^3*p(2)^2*p(3), ...
                    p(2)^3*p(3), p(1)*p(2)^3*p(3), p(1)^2*p(2)^3*p(3), p(2)^4*p(3), p(1)*p(2)^4*p(3), p(2)^5*p(3), p(3)^2, p(1)*p(3)^2, p(1)^2*p(3)^2, p(1)^3*p(3)^2, ...
                    p(1)^4*p(3)^2, p(2)*p(3)^2, p(1)*p(2)*p(3)^2, p(1)^2*p(2)*p(3)^2, p(1)^3*p(2)*p(3)^2, p(2)^2*p(3)^2, p(1)*p(2)^2*p(3)^2, p(1)^2*p(2)^2*p(3)^2, ...
                    p(2)^3*p(3)^2, p(1)*p(2)^3*p(3)^2, p(2)^4*p(3)^2, p(3)^3, p(1)*p(3)^3, p(1)^2*p(3)^3, p(1)^3*p(3)^3, p(2)*p(3)^3, p(1)*p(2)*p(3)^3, p(1)^2*p(2)*p(3)^3, ...
                    p(2)^2*p(3)^3, p(1)*p(2)^2*p(3)^3, p(2)^3*p(3)^3,p(3)^4, p(1)*p(3)^4, p(1)^2*p(3)^4, p(2)*p(3)^4, p(1)*p(2)*p(3)^4, p(2)^2*p(3)^4, p(3)^5, p(1)*p(3)^5, p(2)*p(3)^5, p(3)^6, 1]')';
    elseif size(A,2) == 120
        f = @(p) (A*[p(1), p(1)^2, p(1)^3, p(1)^4, p(1)^5, p(1)^6, p(1)^7, p(2), p(1)*p(2), p(1)^2*p(2), p(1)^3*p(2), p(1)^4*p(2), p(1)^5*p(2), p(1)^6*p(2), p(2)^2, p(1)*p(2)^2, ...
                    p(1)^2*p(2)^2, p(1)^3*p(2)^2, p(1)^4*p(2)^2, p(1)^5*p(2)^2, p(2)^3, p(1)*p(2)^3, p(1)^2*p(2)^3, p(1)^3*p(2)^3, p(1)^4*p(2)^3, p(2)^4, p(1)*p(2)^4, p(1)^2*p(2)^4, ...
                    p(1)^3*p(2)^4, p(2)^5, p(1)*p(2)^5, p(1)^2*p(2)^5, p(2)^6, p(1)*p(2)^6, p(2)^7, p(3), p(1)*p(3), p(1)^2*p(3), p(1)^3*p(3), p(1)^4*p(3), p(1)^5*p(3), p(1)^6*p(3), p(2)*p(3), ...
                    p(1)*p(2)*p(3), p(1)^2*p(2)*p(3), p(1)^3*p(2)*p(3), p(1)^4*p(2)*p(3), p(1)^5*p(2)*p(3), p(2)^2*p(3), p(1)*p(2)^2*p(3), p(1)^2*p(2)^2*p(3), p(1)^3*p(2)^2*p(3), p(1)^4*p(2)^2*p(3), ...
                    p(2)^3*p(3), p(1)*p(2)^3*p(3), p(1)^2*p(2)^3*p(3), p(1)^3*p(2)^3*p(3), p(2)^4*p(3), p(1)*p(2)^4*p(3), p(1)^2*p(2)^4*p(3), p(2)^5*p(3), p(1)*p(2)^5*p(3), p(2)^6*p(3), p(3)^2, ...
                    p(1)*p(3)^2, p(1)^2*p(3)^2, p(1)^3*p(3)^2, p(1)^4*p(3)^2, p(1)^5*p(3)^2, p(2)*p(3)^2, p(1)*p(2)*p(3)^2, p(1)^2*p(2)*p(3)^2, p(1)^3*p(2)*p(3)^2, p(1)^4*p(2)*p(3)^2, ...
                    p(2)^2*p(3)^2, p(1)*p(2)^2*p(3)^2, p(1)^2*p(2)^2*p(3)^2, p(1)^3*p(2)^2*p(3)^2, p(2)^3*p(3)^2, p(1)*p(2)^3*p(3)^2, p(1)^2*p(2)^3*p(3)^2, p(2)^4*p(3)^2, p(1)*p(2)^4*p(3)^2, ...
                    p(2)^5*p(3)^2, p(3)^3, p(1)*p(3)^3, p(1)^2*p(3)^3, p(1)^3*p(3)^3, p(1)^4*p(3)^3, p(2)*p(3)^3, p(1)*p(2)*p(3)^3, p(1)^2*p(2)*p(3)^3, p(1)^3*p(2)*p(3)^3, p(2)^2*p(3)^3, ...
                    p(1)*p(2)^2*p(3)^3, p(1)^2*p(2)^2*p(3)^3, p(2)^3*p(3)^3, p(1)*p(2)^3*p(3)^3, p(2)^4*p(3)^3, p(3)^4, p(1)*p(3)^4, p(1)^2*p(3)^4, p(1)^3*p(3)^4, p(2)*p(3)^4, p(1)*p(2)*p(3)^4, ...
                    p(1)^2*p(2)*p(3)^4, p(2)^2*p(3)^4, p(1)*p(2)^2*p(3)^4, p(2)^3*p(3)^4, p(3)^5, p(1)*p(3)^5, p(1)^2*p(3)^5, p(2)*p(3)^5, p(1)*p(2)*p(3)^5, p(2)^2*p(3)^5, p(3)^6, p(1)*p(3)^6, ...
                    p(2)*p(3)^6, p(3)^7, 1]')';
    elseif size(A,2) == 165
        f = @(p) (A*[p(1), p(1)^2, p(1)^3, p(1)^4, p(1)^5, p(1)^6, p(1)^7, p(1)^8, p(2), p(1)*p(2), p(1)^2*p(2), p(1)^3*p(2), p(1)^4*p(2), p(1)^5*p(2), p(1)^6*p(2), p(1)^7*p(2), ...
                    p(2)^2, p(1)*p(2)^2, p(1)^2*p(2)^2, p(1)^3*p(2)^2, p(1)^4*p(2)^2, p(1)^5*p(2)^2, p(1)^6*p(2)^2, p(2)^3, p(1)*p(2)^3, p(1)^2*p(2)^3, p(1)^3*p(2)^3, p(1)^4*p(2)^3, ...
                    p(1)^5*p(2)^3, p(2)^4, p(1)*p(2)^4, p(1)^2*p(2)^4, p(1)^3*p(2)^4, p(1)^4*p(2)^4, p(2)^5, p(1)*p(2)^5, p(1)^2*p(2)^5, p(1)^3*p(2)^5, p(2)^6, p(1)*p(2)^6, p(1)^2*p(2)^6, ...
                    p(2)^7, p(1)*p(2)^7, p(2)^8, p(3), p(1)*p(3), p(1)^2*p(3), p(1)^3*p(3), p(1)^4*p(3), p(1)^5*p(3), p(1)^6*p(3), p(1)^7*p(3), p(2)*p(3), p(1)*p(2)*p(3), p(1)^2*p(2)*p(3), ...
                    p(1)^3*p(2)*p(3), p(1)^4*p(2)*p(3), p(1)^5*p(2)*p(3), p(1)^6*p(2)*p(3), p(2)^2*p(3), p(1)*p(2)^2*p(3), p(1)^2*p(2)^2*p(3), p(1)^3*p(2)^2*p(3), p(1)^4*p(2)^2*p(3), p(1)^5*p(2)^2*p(3), ...
                    p(2)^3*p(3), p(1)*p(2)^3*p(3), p(1)^2*p(2)^3*p(3), p(1)^3*p(2)^3*p(3), p(1)^4*p(2)^3*p(3), p(2)^4*p(3), p(1)*p(2)^4*p(3), p(1)^2*p(2)^4*p(3), p(1)^3*p(2)^4*p(3), p(2)^5*p(3), ...
                    p(1)*p(2)^5*p(3), p(1)^2*p(2)^5*p(3), p(2)^6*p(3), p(1)*p(2)^6*p(3), p(2)^7*p(3), p(3)^2, p(1)*p(3)^2, p(1)^2*p(3)^2, p(1)^3*p(3)^2, p(1)^4*p(3)^2, p(1)^5*p(3)^2, p(1)^6*p(3)^2, ...
                    p(2)*p(3)^2, p(1)*p(2)*p(3)^2, p(1)^2*p(2)*p(3)^2, p(1)^3*p(2)*p(3)^2, p(1)^4*p(2)*p(3)^2, p(1)^5*p(2)*p(3)^2, p(2)^2*p(3)^2, p(1)*p(2)^2*p(3)^2, p(1)^2*p(2)^2*p(3)^2, ...
                    p(1)^3*p(2)^2*p(3)^2, p(1)^4*p(2)^2*p(3)^2, p(2)^3*p(3)^2, p(1)*p(2)^3*p(3)^2, p(1)^2*p(2)^3*p(3)^2, p(1)^3*p(2)^3*p(3)^2, p(2)^4*p(3)^2, p(1)*p(2)^4*p(3)^2, ...
                    p(1)^2*p(2)^4*p(3)^2, p(2)^5*p(3)^2, p(1)*p(2)^5*p(3)^2, p(2)^6*p(3)^2, p(3)^3, p(1)*p(3)^3, p(1)^2*p(3)^3, p(1)^3*p(3)^3, p(1)^4*p(3)^3, p(1)^5*p(3)^3, p(2)*p(3)^3, ...
                    p(1)*p(2)*p(3)^3, p(1)^2*p(2)*p(3)^3, p(1)^3*p(2)*p(3)^3, p(1)^4*p(2)*p(3)^3, p(2)^2*p(3)^3, p(1)*p(2)^2*p(3)^3, p(1)^2*p(2)^2*p(3)^3, p(1)^3*p(2)^2*p(3)^3, p(2)^3*p(3)^3, ...
                    p(1)*p(2)^3*p(3)^3, p(1)^2*p(2)^3*p(3)^3, p(2)^4*p(3)^3, p(1)*p(2)^4*p(3)^3, p(2)^5*p(3)^3, p(3)^4, p(1)*p(3)^4, p(1)^2*p(3)^4, p(1)^3*p(3)^4, p(1)^4*p(3)^4, p(2)*p(3)^4, ...
                    p(1)*p(2)*p(3)^4, p(1)^2*p(2)*p(3)^4, p(1)^3*p(2)*p(3)^4, p(2)^2*p(3)^4, p(1)*p(2)^2*p(3)^4, p(1)^2*p(2)^2*p(3)^4, p(2)^3*p(3)^4, p(1)*p(2)^3*p(3)^4, p(2)^4*p(3)^4, p(3)^5, ...
                    p(1)*p(3)^5, p(1)^2*p(3)^5, p(1)^3*p(3)^5, p(2)*p(3)^5, p(1)*p(2)*p(3)^5, p(1)^2*p(2)*p(3)^5, p(2)^2*p(3)^5, p(1)*p(2)^2*p(3)^5, p(2)^3*p(3)^5, p(3)^6, p(1)*p(3)^6, ...
                    p(1)^2*p(3)^6, p(2)*p(3)^6, p(1)*p(2)*p(3)^6, p(2)^2*p(3)^6, p(3)^7, p(1)*p(3)^7, p(2)*p(3)^7, p(3)^8, 1]')';
    elseif size(A,2) == 286
        f = @(p) (A*[p(1), p(1)^2, p(1)^3, p(1)^4, p(1)^5, p(1)^6, p(1)^7, p(1)^8, p(1)^9, p(1)^10, p(2), p(1)*p(2), p(1)^2*p(2), p(1)^3*p(2), ...
                    p(1)^4*p(2), p(1)^5*p(2), p(1)^6*p(2), p(1)^7*p(2), p(1)^8*p(2), p(1)^9*p(2), p(2)^2, p(1)*p(2)^2, p(1)^2*p(2)^2, p(1)^3*p(2)^2, ...
                    p(1)^4*p(2)^2, p(1)^5*p(2)^2, p(1)^6*p(2)^2, p(1)^7*p(2)^2, p(1)^8*p(2)^2, p(2)^3, p(1)*p(2)^3, p(1)^2*p(2)^3, p(1)^3*p(2)^3, ...
                    p(1)^4*p(2)^3, p(1)^5*p(2)^3, p(1)^6*p(2)^3, p(1)^7*p(2)^3, p(2)^4, p(1)*p(2)^4, p(1)^2*p(2)^4, p(1)^3*p(2)^4, p(1)^4*p(2)^4, ...
                    p(1)^5*p(2)^4, p(1)^6*p(2)^4, p(2)^5, p(1)*p(2)^5, p(1)^2*p(2)^5, p(1)^3*p(2)^5, p(1)^4*p(2)^5, p(1)^5*p(2)^5, p(2)^6, p(1)*p(2)^6, ...
                    p(1)^2*p(2)^6, p(1)^3*p(2)^6, p(1)^4*p(2)^6, p(2)^7, p(1)*p(2)^7, p(1)^2*p(2)^7, p(1)^3*p(2)^7, p(2)^8, p(1)*p(2)^8, p(1)^2*p(2)^8, ...
                    p(2)^9, p(1)*p(2)^9, p(2)^10, p(3), p(1)*p(3), p(1)^2*p(3), p(1)^3*p(3), p(1)^4*p(3), p(1)^5*p(3), p(1)^6*p(3), p(1)^7*p(3), ...
                    p(1)^8*p(3), p(1)^9*p(3), p(2)*p(3), p(1)*p(2)*p(3), p(1)^2*p(2)*p(3), p(1)^3*p(2)*p(3), p(1)^4*p(2)*p(3), p(1)^5*p(2)*p(3), ...
                    p(1)^6*p(2)*p(3), p(1)^7*p(2)*p(3), p(1)^8*p(2)*p(3), p(2)^2*p(3), p(1)*p(2)^2*p(3), p(1)^2*p(2)^2*p(3), p(1)^3*p(2)^2*p(3), ...
                    p(1)^4*p(2)^2*p(3), p(1)^5*p(2)^2*p(3), p(1)^6*p(2)^2*p(3), p(1)^7*p(2)^2*p(3), p(2)^3*p(3), p(1)*p(2)^3*p(3), p(1)^2*p(2)^3*p(3), ...
                    p(1)^3*p(2)^3*p(3), p(1)^4*p(2)^3*p(3), p(1)^5*p(2)^3*p(3), p(1)^6*p(2)^3*p(3), p(2)^4*p(3), p(1)*p(2)^4*p(3), p(1)^2*p(2)^4*p(3), ...
                    p(1)^3*p(2)^4*p(3), p(1)^4*p(2)^4*p(3), p(1)^5*p(2)^4*p(3), p(2)^5*p(3), p(1)*p(2)^5*p(3), p(1)^2*p(2)^5*p(3), p(1)^3*p(2)^5*p(3), ...
                    p(1)^4*p(2)^5*p(3), p(2)^6*p(3), p(1)*p(2)^6*p(3), p(1)^2*p(2)^6*p(3), p(1)^3*p(2)^6*p(3), p(2)^7*p(3), p(1)*p(2)^7*p(3), ...
                    p(1)^2*p(2)^7*p(3), p(2)^8*p(3), p(1)*p(2)^8*p(3), p(2)^9*p(3), p(3)^2, p(1)*p(3)^2, p(1)^2*p(3)^2, p(1)^3*p(3)^2, p(1)^4*p(3)^2, ...
                    p(1)^5*p(3)^2, p(1)^6*p(3)^2, p(1)^7*p(3)^2, p(1)^8*p(3)^2, p(2)*p(3)^2, p(1)*p(2)*p(3)^2, p(1)^2*p(2)*p(3)^2, p(1)^3*p(2)*p(3)^2, ...
                    p(1)^4*p(2)*p(3)^2, p(1)^5*p(2)*p(3)^2, p(1)^6*p(2)*p(3)^2, p(1)^7*p(2)*p(3)^2, p(2)^2*p(3)^2, p(1)*p(2)^2*p(3)^2, ...
                    p(1)^2*p(2)^2*p(3)^2, p(1)^3*p(2)^2*p(3)^2, p(1)^4*p(2)^2*p(3)^2, p(1)^5*p(2)^2*p(3)^2, p(1)^6*p(2)^2*p(3)^2, p(2)^3*p(3)^2, ...
                    p(1)*p(2)^3*p(3)^2, p(1)^2*p(2)^3*p(3)^2, p(1)^3*p(2)^3*p(3)^2, p(1)^4*p(2)^3*p(3)^2, p(1)^5*p(2)^3*p(3)^2, p(2)^4*p(3)^2, ...
                    p(1)*p(2)^4*p(3)^2, p(1)^2*p(2)^4*p(3)^2, p(1)^3*p(2)^4*p(3)^2, p(1)^4*p(2)^4*p(3)^2, p(2)^5*p(3)^2, p(1)*p(2)^5*p(3)^2, ...
                    p(1)^2*p(2)^5*p(3)^2, p(1)^3*p(2)^5*p(3)^2, p(2)^6*p(3)^2, p(1)*p(2)^6*p(3)^2, p(1)^2*p(2)^6*p(3)^2, p(2)^7*p(3)^2, ...
                    p(1)*p(2)^7*p(3)^2, p(2)^8*p(3)^2, p(3)^3, p(1)*p(3)^3, p(1)^2*p(3)^3, p(1)^3*p(3)^3, p(1)^4*p(3)^3, p(1)^5*p(3)^3, ...
                    p(1)^6*p(3)^3, p(1)^7*p(3)^3, p(2)*p(3)^3, p(1)*p(2)*p(3)^3, p(1)^2*p(2)*p(3)^3, p(1)^3*p(2)*p(3)^3, p(1)^4*p(2)*p(3)^3, ...
                    p(1)^5*p(2)*p(3)^3, p(1)^6*p(2)*p(3)^3, p(2)^2*p(3)^3, p(1)*p(2)^2*p(3)^3, p(1)^2*p(2)^2*p(3)^3, p(1)^3*p(2)^2*p(3)^3, ...
                    p(1)^4*p(2)^2*p(3)^3, p(1)^5*p(2)^2*p(3)^3, p(2)^3*p(3)^3, p(1)*p(2)^3*p(3)^3, p(1)^2*p(2)^3*p(3)^3, p(1)^3*p(2)^3*p(3)^3, ...
                    p(1)^4*p(2)^3*p(3)^3, p(2)^4*p(3)^3, p(1)*p(2)^4*p(3)^3, p(1)^2*p(2)^4*p(3)^3, p(1)^3*p(2)^4*p(3)^3, p(2)^5*p(3)^3, ...
                    p(1)*p(2)^5*p(3)^3, p(1)^2*p(2)^5*p(3)^3, p(2)^6*p(3)^3, p(1)*p(2)^6*p(3)^3, p(2)^7*p(3)^3, p(3)^4, p(1)*p(3)^4, p(1)^2*p(3)^4, ...
                    p(1)^3*p(3)^4, p(1)^4*p(3)^4, p(1)^5*p(3)^4, p(1)^6*p(3)^4, p(2)*p(3)^4, p(1)*p(2)*p(3)^4, p(1)^2*p(2)*p(3)^4, p(1)^3*p(2)*p(3)^4, ...
                    p(1)^4*p(2)*p(3)^4, p(1)^5*p(2)*p(3)^4, p(2)^2*p(3)^4, p(1)*p(2)^2*p(3)^4, p(1)^2*p(2)^2*p(3)^4, p(1)^3*p(2)^2*p(3)^4, ...
                    p(1)^4*p(2)^2*p(3)^4, p(2)^3*p(3)^4, p(1)*p(2)^3*p(3)^4, p(1)^2*p(2)^3*p(3)^4, p(1)^3*p(2)^3*p(3)^4, p(2)^4*p(3)^4, ...
                    p(1)*p(2)^4*p(3)^4, p(1)^2*p(2)^4*p(3)^4, p(2)^5*p(3)^4, p(1)*p(2)^5*p(3)^4, p(2)^6*p(3)^4, p(3)^5, p(1)*p(3)^5, p(1)^2*p(3)^5, ...
                    p(1)^3*p(3)^5, p(1)^4*p(3)^5, p(1)^5*p(3)^5, p(2)*p(3)^5, p(1)*p(2)*p(3)^5, p(1)^2*p(2)*p(3)^5, p(1)^3*p(2)*p(3)^5, ...
                    p(1)^4*p(2)*p(3)^5, p(2)^2*p(3)^5, p(1)*p(2)^2*p(3)^5, p(1)^2*p(2)^2*p(3)^5, p(1)^3*p(2)^2*p(3)^5, p(2)^3*p(3)^5, ...
                    p(1)*p(2)^3*p(3)^5, p(1)^2*p(2)^3*p(3)^5, p(2)^4*p(3)^5, p(1)*p(2)^4*p(3)^5, p(2)^5*p(3)^5, p(3)^6, p(1)*p(3)^6, p(1)^2*p(3)^6, ...
                    p(1)^3*p(3)^6, p(1)^4*p(3)^6, p(2)*p(3)^6, p(1)*p(2)*p(3)^6, p(1)^2*p(2)*p(3)^6, p(1)^3*p(2)*p(3)^6, p(2)^2*p(3)^6, ...
                    p(1)*p(2)^2*p(3)^6, p(1)^2*p(2)^2*p(3)^6, p(2)^3*p(3)^6, p(1)*p(2)^3*p(3)^6, p(2)^4*p(3)^6, p(3)^7, p(1)*p(3)^7, ...
                    p(1)^2*p(3)^7, p(1)^3*p(3)^7, p(2)*p(3)^7, p(1)*p(2)*p(3)^7, p(1)^2*p(2)*p(3)^7, p(2)^2*p(3)^7, p(1)*p(2)^2*p(3)^7, ...
                    p(2)^3*p(3)^7, p(3)^8, p(1)*p(3)^8, p(1)^2*p(3)^8, p(2)*p(3)^8, p(1)*p(2)*p(3)^8, p(2)^2*p(3)^8, p(3)^9, p(1)*p(3)^9, p(2)*p(3)^9, ...
                    p(3)^10, 1]')';
    end
    
    % Disturbed flow
    disturbed_vector = runge_kutta_4_vector(f, p0, detaT);

    p0 = p0 + (step_size*disturbed_vector(:)/norm(disturbed_vector))';
    
%
 
    
    % Angle thr
    if ~all(oldvector==0)
        
        current_point = round(p0);
        c_x = current_point(1,1);
        c_y = current_point(1,2);
        c_z = current_point(1,3);
        
       if   (c_x< 1)||( c_x>99 )||(c_y<1)||(c_y>99)
             break;  
       end
        
        
       if   (c_x> 45)&&( c_x< 62 )&&(c_y>22)&&(c_y< 25)
             break;  
        end
       
       
       
        
        if  ROI_positions_mask(c_x,c_y)==0
            
             break;  
        end
        
        
        
        

 
%         
%         if  mask(c_x,c_y)==0
%             break;                
%         end
 
            Trace = [Trace;p0];

    end
    oldvector = disturbed_vector;
end
 
 


end
